<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Responsible Disclosure: Reflected XSS (Sanitized) — The Cyber Aryan</title>
  <meta name="author" content="Aryan Pareek — The Cyber Aryan">
  <meta name="description" content="A responsible, vendor-safe writeup of a reflected XSS vulnerability (sanitized). Includes impact, safe verification steps, and remediation guidance."/>
  <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&family=Inter:wght@300;400;600&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#0b0710; --panel:rgba(22,12,28,0.7);
      --muted:#bfc8e6; --accent:#00e5ff; --accent2:#b27bff;
      --card:#0f1116;
    }
    *{box-sizing:border-box}
    body{margin:0; font-family:Inter,system-ui; background:
      linear-gradient(180deg, rgba(26,0,43,0.92), rgba(0,28,42,0.95)),
      var(--bg);
      color:var(--muted); -webkit-font-smoothing:antialiased;}
    .container{max-width:900px;margin:36px auto;padding:28px;}
    .post-card{background:linear-gradient(180deg, rgba(255,255,255,0.01), rgba(255,255,255,0.00)); border-radius:12px; padding:28px; border:1px solid rgba(180,120,255,0.05); box-shadow:0 12px 40px rgba(3,3,6,0.6)}
    header .tag{font-family:Orbitron,monospace;color:#e9f7ff; letter-spacing:.6px; font-size:.9rem}
    h1{font-family:Orbitron, sans-serif; color:#ecf3ff; margin:8px 0 6px; text-shadow:0 0 12px rgba(0,229,255,0.08)}
    .meta{color:#9fb7d8; font-size:0.9rem; margin-bottom:18px}
    .lead{color:var(--muted); line-height:1.7; margin-bottom:18px}
    h2{font-family:Orbitron, sans-serif; color:#eaf4ff; margin:22px 0 10px; text-shadow:0 0 6px rgba(0,229,255,0.06)}
    p, li{color:var(--muted); line-height:1.65; font-size:1rem}
    pre{background:rgba(0,0,0,0.35); padding:12px; border-radius:8px; overflow:auto; border:1px solid rgba(255,255,255,0.03); color:#dff;}
    code{font-family:monospace; font-size:0.95rem}
    ul{margin:0 0 12px 1rem}
    .screenshot{margin:12px 0; border-radius:8px; overflow:hidden; border:1px solid rgba(255,255,255,0.03)}
    .screenshot img{width:100%; display:block}
    .cta{margin-top:18px; display:flex; gap:12px; align-items:center; flex-wrap:wrap}
    .btn{background:linear-gradient(90deg,var(--accent2),var(--accent)); padding:10px 14px; border-radius:10px; color:#061118; text-decoration:none; font-weight:700}
    .note{background:rgba(255,255,255,0.02); border-left:4px solid rgba(0,229,255,0.18); padding:10px 12px; border-radius:6px; margin:14px 0}
    footer{margin-top:22px; color:#aabbd6; font-size:0.9rem}
    @media(max-width:720px){ .container{padding:18px} pre{font-size:0.9rem} }
  </style>
</head>
<body>
  <div class="container">
    <article class="post-card">
      <header>
        <div class="tag">// THECYBERARYAN — Research</div>
        <h1>Responsible Disclosure: Reflected XSS (sanitized)</h1>
        <div class="meta">Author: Aryan Pareek • Date: 2025-11-09 • Type: Vendor-safe PoC writeup</div>
      </header>

      <p class="lead">
        This is a responsible, vendor-safe writeup of a <strong>Reflected Cross-Site Scripting (XSS)</strong> issue identified during authorized testing.
        The content is intentionally sanitized: no raw payloads or sensitive values are published. If remediation validation is needed,
        I can share a minimal redacted PoC via an encrypted channel or the vendor’s secure portal.
      </p>

      <h2>Executive summary</h2>
      <p>
        A user-controlled input in a public endpoint is reflected into the HTML response without context-aware output encoding.
        In certain render contexts this allows attacker-supplied script to execute in the victim’s browser if they follow a crafted link.
        Immediate fixes include proper encoding/escaping, stricter Content Security Policy (CSP), and input normalization.
      </p>

      <h2>Observed endpoint & environment</h2>
      <ul>
        <li><strong>Endpoint (example):</strong> <code>/search-products.php</code> (parameter observed: <code>search</code>)</li>
        <li><strong>Method:</strong> GET</li>
        <li><strong>Environment:</strong> Production (reported by researcher)</li>
        <li><strong>Authorization:</strong> Testing performed under permission</li>
      </ul>

      <h2>What I observed (sanitized)</h2>
      <p>
        The application echoes the provided search value directly into the page’s HTML. Because the output was not correctly encoded for the HTML context,
        a crafted value rendered in the browser in a way that allowed client-side script execution. Evidence below is redacted to remain vendor-safe.
      </p>

      <!-- Sanitized screenshots you provided -->
      <div class="screenshot"><img src="San1.png" alt="Sanitized: search input reflected in page"></div>
      <div class="screenshot"><img src="IMG_3608.jpeg" alt="Sanitized: browser alert confirming reflected XSS"></div>

      <h2>Impact</h2>
      <ul>
        <li>Execution of attacker-controlled JavaScript in a victim’s browser</li>
        <li>Risk of session token theft, UI spoofing, or forced actions (depending on app context)</li>
        <li>Damage to user trust and brand reputation via malicious links</li>
      </ul>

      <h2>Safe reproduction steps (for vendors/devs)</h2>
      <p><em>Note:</em> Use staging or masked accounts — do not test with real user data.</p>
      <ol>
        <li>Identify where the search parameter is reflected in the response HTML.</li>
        <li>Render a clearly marked benign token and confirm the exact context (HTML node, attribute, script, or URL).</li>
        <li>Apply context-aware encoding and verify that the token renders as text rather than executable code.</li>
      </ol>

      <h2>Root cause (high level)</h2>
      <p>
        Untrusted input is inserted into server-generated HTML without <strong>context-aware output encoding</strong>.
        In addition, the page lacks a restrictive <strong>Content-Security-Policy</strong> that would reduce XSS impact.
      </p>

      <h2>Safe remediation (developer-focused)</h2>
      <h3>1) Context-aware output encoding</h3>
      <pre><code><!-- HTML text node -->
&lt;div&gt;Search: <strong>&lt;%= htmlEncode(userInput) %&gt;</strong>&lt;/div&gt;

<!-- Attribute context -->
&lt;input value="<strong>&lt;%= attributeEncode(userInput) %&gt;</strong>" /&gt;

<!-- JS context (avoid; otherwise JSON-encode) -->
&lt;script&gt;
  const q = JSON.parse('<strong>&lt;%= jsonEncode(userInput) %&gt;</strong>');
&lt;/script&gt;</code></pre>

      <h3>2) Enforce a restrictive CSP</h3>
      <pre><code>Content-Security-Policy: default-src 'self'; script-src 'self'; object-src 'none'; base-uri 'self'; frame-ancestors 'none';</code></pre>

      <h3>3) Input normalization</h3>
      <ul>
        <li>Trim control characters; limit length of search strings</li>
        <li>Allow-list expected characters for search (letters, digits, spaces)</li>
        <li>Consistently encode/escape wherever the value is rendered</li>
      </ul>

      <h2>Recommendations for immediate mitigation</h2>
      <ul>
        <li>Temporarily filter/strip script-like tokens at the edge (WAF) while fixes ship</li>
        <li>Add security headers (CSP, X-Content-Type-Options, Referrer-Policy)</li>
        <li>Log and monitor unusual query strings and referrers</li>
      </ul>

      <div class="note">
        <strong>Disclosure & evidence handling:</strong> No raw payloads are published. For patch validation, I can provide a minimal redacted PoC over an encrypted channel or your secure portal upon acknowledgement.
      </div>

      <h2>Suggested vendor contact (copyable)</h2>
      <pre><code>Subject: Security report — Reflected XSS on [your-domain]

Hello,
I discovered a reflected XSS affecting (parameter: search). I can share sanitized screenshots and a minimal PoC via an encrypted channel or your secure upload portal. 
Please acknowledge and provide your PGP key or secure link for evidence transfer.

Regards,
Aryan Pareek
CEH | Penetration Tester | The Cyber Aryan
aryanpareek311072004@gmail.com
</code></pre>

      <h2>Conclusion</h2>
      <p>
        Reflected XSS is common but preventable. The durable fix is context-aware encoding at every render point, backed by a strict CSP and input normalization.
        If you are the site owner, contact me via a secure channel — I’ll validate the patch and retest responsibly.
      </p>

      <div class="cta">
        <a class="btn" href="mailto:aryanpareek311072004@gmail.com?subject=Secure%20Contact%20for%20XSS%20PoC">Contact securely (email)</a>
        <a class="btn" href="https://github.com/TheCyberAryan" target="_blank">View tools & scripts</a>
      </div>

      <footer>
        <p>© 2025 Aryan Pareek — The Cyber Aryan. This writeup is vendor-safe and intended for remediation and learning. Do not publish raw payloads or PII.</p>
      </footer>
    </article>
  </div>
</body>
</html>
